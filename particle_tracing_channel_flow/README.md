# Particle tracing: channel flow
This is the channel flow scenario from Section 4.2 of the bachelor's thesis *Flexible mesh-particle coupling with preCICE* by Robin Walloner.

## Contents

### `particle-deal.II/`
The particle tracing participant implemented in deal.II.
- `run.sh` runs the participant.
- `clean.sh` removes all files generated by this participant.
- `src/` contains the source code of the particle participant.
- `parameters.prm` controlls the parameters of the particle tracing.

### `fluid-openfoam/`
The OpenFOAM case used as the fluid participant.
- `run.sh` runs the participant.
- `clean.sh` removes all files generated by this participant.
- The remaining files are the OpenFOAM case files.

### `plot_load_balancing.py`
A script to extract load balancing data from the stdout of the particle participant.

## Reproducing results

### Requirements
- C++ toolchain (tested with [GCC](https://gcc.gnu.org/install/) version 15.1.1)
- [CMake](https://cmake.org/download/) (tested with version 3.31.6)
- [preCICE](https://precice.org/installation-overview.html) (tested with version 3.2.0)
- [deal.II](https://dealii.org/current/readme.html) (tested with version 9.6.2)
- [OpenFOAM](https://www.openfoam.com/current-release) (tested with version 2412)
- [OpenFOAM-preCICE adapter](https://precice.org/adapter-openfoam-get.html) (tested with version 1.3.1)
- [Python](https://www.python.org/downloads/) (tested with version 3.13.5)
- [Python packages](https://packaging.python.org/en/latest/guides/installing-using-pip-and-virtual-environments/#using-a-requirements-file) listed in `requirements.txt`

### Building the particle participant
To build the particle tracing participant:
```sh
mkdir build
cd build
cmake -DCMAKE_BUILD_TYPE=Release ../particle-deal.II
cmake --build .
```

### Running participants
Open two terminals.
In the first terminal, run the fluid participant.
```sh
cd fluid-openfoam
openfoam2412
./clean.sh
./run.sh
```
In the second terminal, run the particle tracing participant.
```sh
cd particle-deal.II
./clean.sh
./run.sh
```
Afterwards, the solution of the particle tracing is available in the `particle-deal.II/solution/` directory.
The OpenFOAM solution is available in the `fluid-openfoam/` directory.

To write the stdout of the particle participant to a file the `plot_load_balancing.py` script can evaluate, you can use:
```sh
./run.sh | tee particle.log
```

### Postprocessing
The results can be visualized, e.g., in ParaView.

To generate the load balancing plot, run:
```sh
python plot_load_balancing.py 
```
