# Single particle sedimentation test

units si

atom_style granular
newton off
# TODO configure neighbors
neigh_modify delay 0

timestep 0.00001

# Define simulation domain
processors * * 1
boundary p p m
region domain block 0 0.004 0 0.004 0 0.006
create_box 1 domain

# TODO use propper interaction model
fix ground all wall/gran &
    model hooke tangential history &
    primitive type 1 zplane 0

# Define and insert particles
# TODO calculate latice spacing based on initial porosity
region insertion_region block 0 0.004 0 0.004 0.003 0.006
lattice sc 0.00045
create_atoms 1 region insertion_region all_in 0.0000000001
set group all diameter 0.0004
set group all density 2500

# Define forces
fix gravity all gravity 9.81 vector 0 0 -1

# TODO user propper interaction model
fix 		m1 all property/global youngsModulus peratomtype 5.e6
fix 		m2 all property/global poissonsRatio peratomtype 0.45
fix 		m3 all property/global coefficientRestitution peratomtypepair 1 0.9
fix 		m4 all property/global coefficientFriction peratomtypepair 1 0.05
fix 		m5 all property/global characteristicVelocity scalar 2.
communicate   single vel yes
pair_style gran model hooke tangential history #Hooke without cohesion
pair_coeff	* *

fix integr all nve/sphere

dump	dmp all custom/vtk 200 post/rti_*.vtk id type type x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius

run 10000
